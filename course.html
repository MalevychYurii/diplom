<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Diplom (test)</title>
    <link rel="stylesheet" href="./src/css/style/courseHTML/style.css" />
    <link rel="stylesheet" href="./src/css/nullstyle/nullstyle.css" />
</head>

<body>
    <header class="header">
        <div class="container">
            <nav class="header__nav">
                <div class="header__logo">
                    <a href="./index.html">
                        <img src="./src/img/logo.png" alt="Logo" class="header__logo-image" />
                    </a>
                </div>
                <div class="header__burger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <ul class="header__menu">
                    <li class="header__menu-item">
                        <a href="./about.html" class="header__link">Про нас</a>
                    </li>
                    <li class="header__menu-item">
                        <a href="./ourMission.html" class="header__link">Наша місія</a>
                    </li>
                    <li class="header__menu-item">
                        <a href="./contact.html" class="header__link">Контакти</a>
                    </li>
                    <li class="header__menu-item">
                        <a href="./learnProcess.html" class="header__link">Процес навчання</a>
                    </li>
                    <li class="header__menu-item">
                        <a href="./course.html" class="header__link">Курс</a>
                    </li>
                    <div class="header__actions">
                        <a href="" class="header__link header__link--registration">Зареєструватися</a>
                        <button type="button" class="header__button header__button--login">Увійти</button>

                        <!-- Місце для email користувача та кнопка виходу -->
                        <div id="user-email" class="header__user-info" style="display: none;">
                            <span id="user-email-display"></span> <!-- Для відображення email -->
                            <button id="logoutBtn" type="button"
                                class="header__button header__button--logout">Вийти</button>
                        </div>
                    </div>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main">
        <section class="course">
            <div id="course-root"></div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__block">
                    <div class="footer__img">
                        <a href="./index.html"><img src="./src/img/logo.png" alt="Logo" /></a>
                    </div>
                    <div class="footer__item">
                        <ul>
                            <li><a href="">Про нас</a></li>
                            <li><a href="">Чому ви навчитесь?</a></li>
                            <li><a href="">Реєстрація</a></li>
                            <li><a href="">Локація</a></li>
                        </ul>
                    </div>
                    <div class="footer__item">
                        <div class="footer__contact">
                            <div class="footer__contact--title">Зв'язатись з нами:</div>
                            <div class="footer__contact--tel">
                                <a href="tel:+38050549921">+38 (050) 549 921</a>
                            </div>
                            <div class="footer__contact--mail">
                                <a href="mailto:test@gmail.com" target="_blank">test@gmail.com</a>
                            </div>
                        </div>
                    </div>
                    <div class="footer__item">
                        <div class="footer__social">
                            <ul class="footer__social--list">
                                <li class="footer__social--item">
                                    <a href="">
                                        <img src="./src/img/svg/footerSocial/linkedIn.svg" alt="linkedIn" />
                                    </a>
                                </li>
                                <li class="footer__social--item">
                                    <a href="">
                                        <img src="./src/img/svg/footerSocial/facebook.svg" alt="facebook" />
                                    </a>
                                </li>
                                <li class="footer__social--item">
                                    <a href="">
                                        <img src="./src/img/svg/footerSocial/telegram.svg" alt="telegram" />
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <a href="#" class="scroll-to-top" id="scrollToTop">&#8679;</a>
    <!-- React та Babel через CDN -->
    <script type="text/babel">
        const { useState, useEffect } = React;

        function CourseApp() {
            const [activeSection, setActiveSection] = useState(null);
            const [activeSubsection, setActiveSubsection] = useState(null);
            const [activeTopic, setActiveTopic] = useState(null);
            const [quizMode, setQuizMode] = useState(false);
            const [quizIndex, setQuizIndex] = useState(0);
            const [quizQuestions, setQuizQuestions] = useState([]);
            const [score, setScore] = useState(0);
            const [selectedAnswer, setSelectedAnswer] = useState(null);
            const [activeTense, setActiveTense] = useState(null);
            const [activeSubtense, setActiveSubtense] = useState(null);

            const [results, setResults] = useState(() => {
                const raw = JSON.parse(localStorage.getItem("quizResults")) || {};
                if (!raw.words && Object.values(raw).every(val => typeof val === "number")) {
                    return { words: raw };
                }
                return raw;
            });

            const vocabularyData = {
                "Фрукти": [{ en: "apple", ua: "яблуко" }, { en: "banana", ua: "банан" }, { en: "orange", ua: "апельсин" }, { en: "grape", ua: "виноград" }, { en: "pear", ua: "груша" }, { en: "cherry", ua: "вишня" }, { en: "peach", ua: "персик" }, { en: "plum", ua: "слива" }, { en: "watermelon", ua: "кавун" }, { en: "melon", ua: "диня" }],
                "Тварини": [{ en: "cat", ua: "кіт" }, { en: "dog", ua: "пес" }, { en: "elephant", ua: "слон" }, { en: "lion", ua: "лев" }, { en: "tiger", ua: "тигр" }, { en: "rabbit", ua: "кролик" }, { en: "horse", ua: "кінь" }, { en: "cow", ua: "корова" }, { en: "sheep", ua: "вівця" }, { en: "goat", ua: "коза" }],
                "Професії": [{ en: "doctor", ua: "лікар" }, { en: "teacher", ua: "вчитель" }, { en: "engineer", ua: "інженер" }, { en: "nurse", ua: "медсестра" }, { en: "driver", ua: "водій" }, { en: "chef", ua: "шеф-кухар" }, { en: "actor", ua: "актор" }, { en: "artist", ua: "художник" }, { en: "musician", ua: "музикант" }, { en: "writer", ua: "письменник" }],
                "Кольори": [{ en: "red", ua: "червоний" }, { en: "blue", ua: "синій" }, { en: "green", ua: "зелений" }, { en: "yellow", ua: "жовтий" }, { en: "black", ua: "чорний" }, { en: "white", ua: "білий" }, { en: "pink", ua: "рожевий" }, { en: "purple", ua: "фіолетовий" }, { en: "orange", ua: "помаранчевий" }, { en: "brown", ua: "коричневий" }],
                "Частини тіла": [{ en: "head", ua: "голова" }, { en: "hand", ua: "рука" }, { en: "leg", ua: "нога" }, { en: "eye", ua: "око" }, { en: "ear", ua: "вухо" }, { en: "mouth", ua: "рот" }, { en: "nose", ua: "ніс" }, { en: "neck", ua: "шия" }, { en: "shoulder", ua: "плече" }, { en: "foot", ua: "стопа" }],
                "Одяг": [{ en: "shirt", ua: "сорочка" }, { en: "pants", ua: "штани" }, { en: "jacket", ua: "куртка" }, { en: "dress", ua: "сукня" }, { en: "shoes", ua: "взуття" }, { en: "coat", ua: "пальто" }, { en: "scarf", ua: "шарф" }, { en: "hat", ua: "капелюх" }, { en: "gloves", ua: "рукавички" }, { en: "socks", ua: "носки" }]
            };

            const grammarTensesContent = {
                past: [
                    { name: 'Past Simple', description: 'Use for completed actions in the past. Structure: Subject + V2 (e.g., I walked to the store).' },
                    { name: 'Past Continuous', description: 'Use for actions in progress at a specific time in the past. Structure: Subject + was/were + V-ing (e.g., They were watching TV).' },
                    { name: 'Past Perfect', description: 'Use for an action completed before another past action. Structure: Subject + had + V3 (e.g., She had left before I arrived).' },
                    { name: 'Past Perfect Continuous', description: 'Use for duration of an action up to a point in the past. Structure: Subject + had been + V-ing (e.g., He had been working all day).' }
                ],
                present: [
                    { name: 'Present Simple', description: 'Use for habitual actions or general truths. Structure: Subject + V1(s) (e.g., She speaks English).' },
                    { name: 'Present Continuous', description: 'Use for actions happening now or around now. Structure: Subject + am/is/are + V-ing (e.g., I am reading a book).' },
                    { name: 'Present Perfect', description: 'Use for actions with relevance to the present. Structure: Subject + have/has + V3 (e.g., They have visited Paris).' },
                    { name: 'Present Perfect Continuous', description: 'Use for duration up to now. Structure: Subject + have/has been + V-ing (e.g., We have been waiting here).' }
                ],
                future: [
                    { name: 'Future Simple', description: 'Use for spontaneous decisions or predictions. Structure: Subject + will + V1 (e.g., I will call you later).' },
                    { name: 'Future Continuous', description: 'Use for actions in progress at a future time. Structure: Subject + will be + V-ing (e.g., She will be traveling tomorrow).' },
                    { name: 'Future Perfect', description: 'Use for actions that will be completed before a future time. Structure: Subject + will have + V3 (e.g., They will have finished by Monday).' },
                    { name: 'Future Perfect Continuous', description: 'Use for duration up to a future point. Structure: Subject + will have been + V-ing (e.g., He will have been working here for five years).' }
                ]
            };

            const sections = {
                words: { title: 'Vocabulary', subsections: { vocabulary: 'Список тем', flashcards: 'Посилання для навчання' } },
                grammar: { title: 'Grammar', subsections: { tenses: 'Часи англійської мови', articles: 'Артиклі', conditionals: 'Умовні речення' } },
                listening: { title: 'Listening', subsections: { beginner: 'Аудіо для початківців', advanced: 'Аудіо для просунутих' } },
                speaking: { title: 'Speaking', subsections: { pronunciation: 'Вправи на вимову', dialogue: 'Практика діалогів' } },
                grades: { title: 'Оцінки', subsections: {} }
            };

            const handleBack = () => {
                if (quizMode) return setQuizMode(false);
                if (activeSubtense) return setActiveSubtense(null);
                if (activeTense) return setActiveTense(null);
                if (activeTopic) return setActiveTopic(null);
                if (activeSubsection) return setActiveSubsection(null);
                setActiveSection(null);
            };

            const startQuiz = () => {
                const words = vocabularyData[activeTopic];
                const shuffled = [...words].sort(() => 0.5 - Math.random()).slice(0, 10);
                const questions = shuffled.map(word => {
                    const incorrect = words.filter(w => w.en !== word.en).sort(() => 0.5 - Math.random()).slice(0, 5);
                    const options = [...incorrect.map(w => w.en), word.en].sort(() => 0.5 - Math.random());
                    return { question: word.ua, correct: word.en, options };
                });
                setQuizQuestions(questions);
                setQuizIndex(0);
                setScore(0);
                setSelectedAnswer(null);
                setQuizMode(true);
            };

            const handleAnswer = (selected) => {
                if (selectedAnswer) return;
                setSelectedAnswer(selected);
                setTimeout(() => {
                    const correct = quizQuestions[quizIndex].correct;
                    const isCorrect = selected === correct;
                    if (isCorrect) setScore(prev => prev + 1);

                    if (quizIndex + 1 < quizQuestions.length) {
                        setQuizIndex(prev => prev + 1);
                        setSelectedAnswer(null);
                    } else {
                        const finalScore = score + (isCorrect ? 1 : 0);
                        const updatedResults = {
                            ...results,
                            words: { ...(results.words || {}), [activeTopic]: finalScore }
                        };
                        setResults(updatedResults);
                        localStorage.setItem("quizResults", JSON.stringify(updatedResults));
                        alert(`Тест завершено! Ваш результат: ${finalScore} з 10`);
                        setQuizMode(false);
                        setActiveTopic(null);
                        setSelectedAnswer(null);
                    }
                }, 1000);
            };

            return (
                <div className="course">
                    {/* Main Menu */}
                    {!activeSection && (
                        <div className="course__menu">
                            <h1 className="course__main-title">Ваш відділ знань</h1>
                            <p>Тут ми вчимо англійську крок за кроком, легко та з задоволенням. У кожному
                                розділі — нові теми, практичні завдання та інструменти для закріплення знань. Обирай: вивчай слова,
                                граматику, тренуй аудіювання чи розвивай навички мовлення. Усе, що потрібно для впевненого
                                спілкування
                                англійською — вже тут!</p>
                            {Object.entries(sections).map(([key, value]) => (
                                <button
                                    key={key}
                                    onClick={() => setActiveSection(key)}
                                    className="course__menu-item"
                                >
                                    {value.title}
                                </button>
                            ))}
                        </div>
                    )}


                    {activeSection === "grades" && (
                        <div className="course__section">
                            <button onClick={handleBack} className="course__back">⇦ Назад</button>
                            <h2>Оцінки</h2>
                            {Object.keys(results).length > 0 ? (
                                <ul>
                                    {Object.entries(results).map(([category, topics]) => (
                                        <li key={category}>
                                            <strong>{sections[category]?.title || category}</strong>
                                            <ul>
                                                {Object.entries(topics).map(([topic, score]) => (
                                                    <li key={topic}>Тема: {topic} — Оцінка: {score} / 10</li>
                                                ))}
                                            </ul>
                                        </li>
                                    ))}
                                </ul>
                            ) : (
                                <p>Ще немає результатів тестів.</p>
                            )}
                        </div>
                    )}

                    {activeSection && activeSection !== "grades" && !activeSubsection && (
                        <div className="course__section">
                            <button onClick={handleBack} className="course__back">⇦ Назад</button>
                            <h2>{sections[activeSection].title}</h2>
                            <div className="course__submenu">
                                {Object.entries(sections[activeSection].subsections).map(([subKey, subTitle]) => (
                                    <button key={subKey} onClick={() => setActiveSubsection(subKey)} className="course__submenu-item">
                                        {subTitle}
                                    </button>
                                ))}
                            </div>
                        </div>
                    )}

                    {activeSection === 'grammar' && activeSubsection === 'tenses' && (
                        <div className="course__section">
                            <button onClick={handleBack} className="course__back">⇦ Назад</button>
                            {!activeTense ? (
                                <>  {/* Select Group */}
                                    <h2>{sections.grammar.subsections.tenses}</h2>
                                    <div className="course__submenu">
                                        {Object.keys(grammarTensesContent).map(key => (
                                            <button
                                                key={key}
                                                onClick={() => setActiveTense(key)}
                                                className="course__submenu-item"
                                            >
                                                {key.charAt(0).toUpperCase() + key.slice(1)}
                                            </button>
                                        ))}
                                    </div>
                                </>
                            ) : !activeSubtense ? (
                                <>  {/* Select Tense */}
                                    <h2>{activeTense.charAt(0).toUpperCase() + activeTense.slice(1)}</h2>
                                    <div className="course__submenu">
                                        {grammarTensesContent[activeTense].map(({ name }) => (
                                            <button
                                                key={name}
                                                onClick={() => setActiveSubtense(name)}
                                                className="course__submenu-item"
                                            >
                                                {name}
                                            </button>
                                        ))}
                                    </div>
                                </>
                            ) : (
                                <>  {/* Tense Details */}
                                    <h2>{activeSubtense}</h2>
                                    <p>{grammarTensesContent[activeTense].find(item => item.name === activeSubtense).description}</p>
                                </>
                            )}
                        </div>
                    )}

                    {activeSubsection && activeSubsection !== 'tenses' && !activeTopic && (
                        <div className="course__section">
                            <button onClick={handleBack} className="course__back">⇦ Назад</button>
                            <h2>{sections[activeSection].subsections[activeSubsection]}</h2>

                            {activeSubsection === "vocabulary" && (
                                <div className="course__submenu">
                                    {Object.keys(vocabularyData).map(topic => (
                                        <button
                                            key={topic}
                                            onClick={() => setActiveTopic(topic)}
                                            className="course__submenu-item"
                                        >
                                            {topic}
                                        </button>
                                    ))}
                                </div>
                            )}

                            {activeSubsection === "flashcards" && (
                                <div>
                                    <ul>
                                        <p>1. Розвиваємо пам'ять:</p>
                                        <li><a href="https://happymonday.ua/jak-pokrashhyty-pamjat" target="_blank">Посилання</a></li>
                                        <p>2. Тренування на вимову:</p>
                                        <li><a href="https://youglish.com/" target="_blank">Посилання</a></li>
                                        <p>3. Реальні аудіоуроки з життя:</p>
                                        <li><a href="https://www.eslpod.com/" target="_blank">Посилання</a></li>
                                        <p>4. Вправи на граматику:</p>
                                        <li><a href="https://agendaweb.org/" target="_blank">Посилання</a></li>
                                        <p>5. Збірка вправ для початківців:</p>
                                        <li><a href="https://happymonday.ua/jak-pokrashhyty-pamjat" target="_blank">Посилання</a></li>
                                    </ul>
                                </div>
                            )}
                        </div>
                    )}


                    {activeTopic && !quizMode && (
                        <div className="course__section">
                            <button onClick={handleBack} className="course__back">⇦ Назад</button>
                            <h2>{activeTopic}</h2>
                            <ul className="vocabulary-list">
                                {vocabularyData[activeTopic].map((word, index) => (
                                    <li key={index}><strong>{word.en}</strong> — {word.ua}</li>
                                ))}
                            </ul>
                            {!(results.words && results.words[activeTopic]) && (
                                <button onClick={startQuiz} className="course__quiz-button">Пройти тест</button>
                            )}
                        </div>
                    )}

                    {quizMode && (
                        <div className="course__section">
                            <h2>Питання {quizIndex + 1} з {quizQuestions.length}</h2>
                            <p><strong>Перекладіть:</strong> {quizQuestions[quizIndex].question}</p>
                            <div className="quiz-options">
                                {quizQuestions[quizIndex].options.map((opt, idx) => {
                                    let className = "quiz__option-button";
                                    if (selectedAnswer) {
                                        if (opt === quizQuestions[quizIndex].correct) className += " correct";
                                        else if (opt === selectedAnswer) className += " incorrect";
                                        else className += " disabled";
                                    }
                                    return (
                                        <button
                                            key={idx}
                                            onClick={() => handleAnswer(opt)}
                                            className={className}
                                            disabled={!!selectedAnswer}
                                        >
                                            {opt}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('course-root')).render(<CourseApp />);
    </script>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="./src/js/upArrow.js"></script>
    <script src="./src/js/modal.js"></script>
    <script src="./src/js/hideSection.js"></script>
    <script defer src="./src/js/burger.js"></script>
</body>

</html>